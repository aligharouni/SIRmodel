\documentclass[12pt]{article}
\usepackage{natbib}
\usepackage{hyperref}
\usepackage{grffile}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{amssymb,amsmath,amsthm}
\usepackage{xcolor}
\usepackage{xspace}
\usepackage[nameinlink,capitalize]{cleveref}
\usepackage{cleveref}
\usepackage[margin=1in]{geometry}
\usepackage{lineno}\renewcommand\thelinenumber{\color{gray}\arabic{linenumber}}
\usepackage{pdflscape}
\usepackage{enumerate}

%% FIXME: uncomment when this pipeline is working
\input{codes/modeldefs.tex}

% https://tex.stackexchange.com/questions/12703/how-to-create-fixed-width-table-columns-with-text-raggedright-centered-raggedlef
\usepackage{array}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

\usepackage{xspace}

\newcommand{\fref}[1]{Fig.~\ref{#1}}
\newcommand{\Rlogo}{R\xspace}
\newcommand{\percap}{\emph{per capita}\xspace}
\newcommand{\Rnum}{\ensuremath{\mathcal{R}_0}\xspace}
\newcommand{\covid}{COVID-19\xspace}
\newcommand{\pro}[1]{\ensuremath{\frac{\partial #1}{\partial \rho}}}
\newcommand\pder[2]{\ensuremath{\frac{\partial#1}{\partial#2}}} %\pder y{x}

\newcommand*\subtxt[1]{_{\textnormal{#1}}}
\DeclareRobustCommand\_{\ifmmode\expandafter\subtxt\else\textunderscore\fi}

\newcommand{\comment}{\showcomment}
\newcommand{\showcomment}[3]{\textcolor{#1}{\textbf{[#2: }\textsl{#3}\textbf{]}}}
\newcommand{\nocomment}[3]{}

\newcommand{\fady}[1]{\comment{cyan}{Fady}{#1}}
\newcommand{\ali}[1]{\comment{magenta}{Ali}{#1}}
\newcommand{\jd}[1]{\comment{blue}{JD}{#1}}
\newcommand{\david}[1]{\comment{red}{DJDE}{#1}}
\newcommand{\bmb}[1]{\comment{red}{BMB}{#1}}
\newcommand{\todo}[1]{\comment{red}{TODO}{#1}}

\theoremstyle{definition} % amsthm only
\newtheorem{proposition}{Proposition}
\newtheorem{theorem}{Theorem}

\bibliographystyle{apalike}

\title{Testing and Isolation Efficacy: Insights from a Simple Epidemic Model}

\begin{document}
\maketitle

\linenumbers

% %%%%%%%
\section{Abstract}

\bmb{abstract needs another editing pass, skipping for now}

The effect of testing processes, including testing and test reporting, on epidemic dynamics, involving infection and recovery, can be studied at the individual level or the community level (e.g., nursing homes, long-term-care facilities, etc.).
Gaining insights to determine the sensitivity of the epidemic dynamics with respect to the testing processes will depend on underlying factors including the level of focus (individual or community), assumptions (model), and the interplay between these factors. 
In particular, fast testing and test reporting may be beneficial at the community-level, supported by many studies, as it gives a rapid assessment of the situation, identifies hot spots, and may enable rapid contact-tracing. However, the potential advantage of a slow rate of test return on the dynamics of an epidemic is real, often neglected, and needs to be quantified. At the individual level, this advantage can manifest in the following sense: individuals awaiting their test results or who have tested positive may partially or fully self-isolate, thus reducing or eliminating their potential in the transmission process.
In this paper, we investigated this individual-level effect of testing processes on the epidemic dynamics by developing a SIR-type model.
Although the model development was motivated by the \covid epidemic, the model has general epidemiological and testing structures. The realistic components of the model include \percap testing intensity, test sensitivity and specificity, rate of test return, and isolation efficacy (i.e., reduction of the transmission probability by isolating individuals). The novel component is the compartment-specific relative testing weights, which reflect the testing strategies-- surveillance, diagnosis, or control. Here, we compare two testing strategies, random vs. targeted, and concluded that increasing testing “focus” from random to targeted always decreases \Rnum. Further, the following processes always decreases $\Rnum$; increasing the isolation efficacy parameters for tested and confirmed individuals, higher testing intensity if testing is random or testing intensity is small, and a higher rate of test return if the isolation efficacy for tested-awaiting individuals is low.

% %%%%%%%
\section{Introduction}

%% FIXME: uncomment when pipeline works
$\beta=\betaparam$; $\gamma=\gammaparam$

The observed dynamics of the \covid epidemic have been driven both by epidemiological processes (infection and recovery) and by testing processes (testing and test reporting). In addition to shaping epidemic observations (via case reports), testing processes also alter epidemiological dynamics. Because individuals with confirmed infections (positive tests) are likely to self-isolate, and individuals who are awaiting the results of a test may also do so (possibly to a lesser extent), testing will generally increase the number of people who are isolating and hence reduce epidemic growth rates. We developed a mechanistic model that incorporates epidemic processes and testing in order to explore the effects of testing and isolation on epidemic dynamics.

If testing influences behavior, then epidemic dynamics will depend on who gets tested.
The impacts of testing will depend both on testing intensity (tests performed per day) and on how strongly testing is focused on people who are infectious.
This level of focus depends in turn on the purpose and design of testing programs. 
When testing is done for the purposes of disease surveillance \citep{foddai2020base}
tests are typically assigned randomly (or using a stratified random design) across the population in
order to make an unbiased assessment of population prevalence.

Over the course of the \covid pandemic, however, the vast majority of testing has been done with other goals --
primarily diagnostic (determining infection status for clinical purposes), or for control (determining  infection status in order to isolate cases that have been found by contact tracing), which we characterize as \emph{targeted} testing strategies.
In these cases, testing probabilities vary widely across epidemiological compartments; in our dynamical model, we will characterize these probabilities by assigning a \percap testing weight to each compartment that determines the \emph{relative} probability that an individual in that compartment will be selected for testing (see Methods). 

Diagnostic testing focuses on people with infection-like symptoms; thus the relative testing weights for infected people will depend on the relative probability of infected people having symptoms. For \covid infection, the testing weights will depend on the proportion of asymptomatic infections, the time spent pre-symptomatic vs.\ symptomatic during the course of an infection, and on the incidence of \covid-like symptoms among people in the population \emph{not} infected with \covid. Testing for epidemic control focuses on known contacts of infected people; in this case the testing weights for infected vs.\ uninfected people will depend on the probability of infection given contact, as well as the effectiveness of the system for identifying suspicious contacts.

As epidemiologists, we want to know whether an epidemic will initially grow exponentially following its introduction in a susceptible population. In mathematical epidemiology, we determine this outcome by studying the basic reproduction number $\Rnum$, defined as the expected number of secondary infections arising from a typical infective individual in a completely susceptible population \citep{dietz1993estimation}. 
In the early stages of an epidemic the number of infected individuals is expected to grow exponentially over time when $\Rnum>1$.
%% BMB left out the converse; don't think we have to be super-precise here
Although the value of $\Rnum$ cannot completely characterize the dynamics of even the simplest epidemic model
\citep{shaw2021what}, it does give a simple and widely accepted index for the difficulty of control, as well as an indication of the likely final size of an epidemic \citep{ma2006generality}.  

In order to understand the effect of testing processes on an epidemic dynamics, we developed a mechanistic SIR-type model with epidemic and testing components. This model provides a sensible platform to link the modeling of epidemic and testing components and study their interaction. Here, we studied the the effect of testing intensity, rate of test return and the isolation efficacy in reduction of the probability of transmission on the epidemic dynamics when different levels of testing focus (from random to highly targeted) are in place.
% Our model provides insights to the sensitivity of the epidemic dynamics, through $\Rnum$, with respect to the underlying testing and isolation parameters.
%% BMB: last sentence seems to belong in conclusions

% %%%%%%%
\section{Methods}

We developed a deterministic model, Eqs.~\eqref{model}, which groups individuals based on disease status and testing status. Disease states include Susceptible, Infectious and Recovered; testing status categorizes people as \emph{untested}, waiting-for-\emph{positive}, waiting-for-\emph{negative}, or \emph{confirmed positive} (\fref{fig:flowchart}). The testing status of an individual in  a given disease compartment $X$ (where $X \in \{S,I,R\}$) is denoted by a subscript, namely $X\_u$, $X\_p$, $X\_n$ and $X\_c$, for \emph{untested}, waiting-for-\emph{positive}, waiting-for-\emph{negative}, or \emph{confirmed positive}, respectively.
Further, two `accumulator' compartments, $N$ and $P$, are included in order to collect cumulative reported negative or positive tests. The model equations and details of calculation of the basic reproduction number $\Rnum$ are presented in the appendix (Sec. \ref{app:R0}).

\begin{figure}
\begin{center} 
\includegraphics[scale=1.5]{pix/sir_comp.pdf}
\caption{\small Flowchart of the SIR (Susceptible-Infectious-Recovered) model, \ref{model}. The disease-based status of a compartment $X$ ($X \in \{S,I,R\}$) is combined with the testing status including $X\_u$, $X\_p$, $X\_n$ and $X\_c$, for \emph{untested}, waiting-for-\emph{positive}, waiting-for-\emph{negative}, or \emph{confirmed positive}, respectively. The force of infection is denoted by $\Lambda$ (Eq.~\eqref{Lambda}); $\gamma$ is the recovery rate; $\omega$ is the rate of test return; and $F_X$ (Eq. \eqref{F}) and $p_X$ represent the \percap testing rate and the sensitivity (probability of positive tests), respectively, for compartment $X$. For further description of the parameters see \cref{tab:params}.
Note that there is a slight mismatch in the top-to-bottom order of the testing-based compartments of each disease-based compartment $X$ between this flowchart and the model equations \eqref{model}; here we have switched  $X\_u$ and $X\_n$ for visual clarity.
\label{fig:flowchart}}
\end{center} 
\end{figure}

Table~\ref{tab:params} defines the model parameters, which are generally \percap flows between compartments, or modifiers to these flow rates. The novel component of the model lies in the compartment-specific relative testing weights $w_S$, $w_I$ and $w_R$; these give the relative rates at which people in the $S$, $I$, and $R$ compartments are tested, respectively. Thus, we can specify different levels of testing focus from random (all weights equal) to highly targeted (higher weights in more intensively tested compartments). For example, $w_I/w_S=3$ means that infected individuals are tested at three times the \percap rate of susceptible individuals. 

In order to allow parameterization of the model by the total (overall) \percap testing rate, we define the weighted size of the testing pool $W = w_S S\_u + w_I I\_u + w_R R\_u$, and calculate a scaling parameter for testing as:
\begin{equation}
\label{sigma}
\sigma = \frac{\rho N_0}{W},
\end{equation}
where $\rho$ is the \percap testing intensity for the population, defined as the number of daily tests administered in a population of size $N_0$.
Thus, the \percap testing rate for compartment $X$ is 
\begin{equation}
\label{F}
F_X=\sigma w_X,\,\, \text{where}\, X \in \{S,I,R\}.
\end{equation}
For a highly sensitive test, infected people typically flow through to the ``confirmed positive'' ($I\_c$, $R\_c$) compartments and are thus unavailable for further testing.  Over the course of the epidemic, a sufficiently large fixed testing rate as specified in \eqref{sigma} can exhaust the pool of people available for testing, leading to a singularity when too few people are left untested to support the specified rate. Although this phenomenon does not affect our analysis of $\Rnum$, it can affect the temporal dynamics (in the appendix we present an adjustment to the model that solves this problem).

The classical SIR model assumes a well-mixed population; homogeneity of the population (i.e., all individuals are equally susceptible and equally infectious with the same recovery rate when infected); exponentially distributed duration of infection; and large population size \citep{keeling2011modeling}. In addition to these standard assumptions, our model assumes: 
\begin{enumerate}[(i)]
\item there is a single force of infection (new cases per unit time), $\Lambda$, defined as
  \begin{equation}
  \label{Lambda}
  \Lambda=\frac{\beta}{N_0} \big(I\_u + (1-\theta\_w)(I\_n+I\_p) + (1-\theta\_c)I\_c \big),
  \end{equation}
  with transmission rate $\beta$; $\theta\_w$ is the isolation efficacy (reduction of the probability of transmission) for individuals waiting for test results, while $\theta\_c$ is the isolation efficacy for individuals who have received a positive test (``confirmed positive'': Table~\ref{tab:params}). Susceptible individuals who are waiting for test results experience an additional transmission factor of $1-\theta\_w$ (\fref{fig:flowchart}). 
\item confirmed-positive individuals isolate more effectively than those awaiting test results, i.e.
$$0\leq\theta\_w\leq\theta\_c\leq 1.$$ 
\end{enumerate}
For simplicity we assume that tests are perfectly \emph{specific} --- uninfected individuals never test positive ($p_s=0$). Thus there are no waiting-for-positive or confirmed-positive susceptible individuals (we assume that these states are also absent from the initial conditions, i.e. $S\_p(0)=S\_c(0)=0$), which reduces the number of model states from 12 to 10.

\begin{table}[htp]
\centering
\begin{tabular}{|c|L{2in}cc|} \hline
  Symbol & Description & Unit & Value \\ \hline
  $N_0$     & Total population size & people & $10^6$ \\ \hline
  $\omega$  & Rate of test return, i.e., rate of onward flow from ``waiting'' to ``confirmed'' or ``untested'' compartments  & 1/day & - \\ \hline
  $\gamma$ & Recovery rate & 1/day & 1/6 \\ \hline 
  $\rho$   & \percap testing intensity & 1/day & - \\ \hline 
  $\theta\_w$ & Isolation efficacy (reduction of the transmission probability) for ``waiting'' individuals & - & - \\ \hline
  $\theta\_c$ & Isolation efficacy for ``confirmed positive'' individuals & - & -  \\ \hline
  $\beta$ & Transmission rate & 1/day & 0.5 \\ \hline
  $\Lambda$ & Force of infection & 1/day & - \\ \hline
  $p_S$ & Probability of positive tests for $S$ ($= 1-\textrm{specificity}$) & - & 0 \\ \hline
  $p_I$ & Probability of positive tests for $I$ ($= \textrm{sensitivity}$) & - & 1 \\ \hline
  $p_R$ & Probability of positive tests for $R$ ($= 1-\textrm{specificity}$) & - & 0.5 \\ \hline
  $w_S, w_I, w_R$ & Relative testing weights & - &
  \begin{minipage}[t]{0.21\columnwidth}%
    Random: $\{1,1,1\}$ \\ Targeted: $\{0.3,1,1\}$
  \end{minipage} \\
  \hline
  \end{tabular}
\caption{\label{tab:params} Parameters of the model \eqref{model}.}
\end{table}

The Disease-Free Equilibrium (DFE) for the SIR model (Eqs.\,\ref{model}) is found by setting the infected compartments to 0 and solving for the unknowns. The DFE is
\begin{equation}
\label{dfe}
S\_n^*= \frac{\rho}{\omega}\,N_0, \ S\_u^*= \frac{\omega-\rho}{\omega}\,N_0, \text{~and~} I_j=R_j=0 \ \text{for all }j.
\end{equation}
The corresponding \percap testing rate (Eq.\,\ref{F}) for the infected compartment $I$ at DFE is one of the key analysis parameters and can be simplified as 
\begin{equation}
\label{eq:fi}
\hat F_I = (\omega\rho/(\omega-\rho))w_I/w_S \quad .
\end{equation}

The basic reproduction number, $\Rnum$, was calculated by using the next-generation matrix method \citep{van2002reproduction}. We present $\Rnum$ in the following form.
\begin{equation}
\label{R0}
\Rnum= \frac{\beta}{\gamma} (1-\Delta), 
\end{equation}
where the term $\frac{\beta}{\gamma}$ is the classical basic reproduction number for a SIR model without testing and isolation \citep{keeling2011modeling}, and the positive quantity $\Delta$ is the effectiveness of control due to testing and isolation processes defined as 
\begin{equation}
  \label{eq:del4a}
  \Delta= \frac{1}{C N_0}\big(C_1 S\_u^*+(C_2(1-\theta\_w)+C \theta\_w)S\_n^*\big),
\end{equation}
where
\begin{align}
\label{eq:C12}
C_{\phantom 1} &= (\omega+\gamma) \Big(\gamma(\omega+\gamma)+(\gamma+\omega p_I)\hat F_I\Big),\\
C_1 &= (\omega+\gamma)(\theta\_w \gamma+\theta\_c \omega p_I) \hat F_I,\\
C_2 &= \Big( \omega\gamma(1+p_I)\hat F_I+\gamma^2(\omega+\gamma+\hat F_I)\Big)\theta\_w + \omega^2p_I\hat F_I\theta\_c.
\end{align}
Further details of derivation of $\Rnum$ are provided in appendix, Sec.\,\ref{app:R0}. 
The explicit formula of $\Rnum$ enables us to study the effects of testing and isolation parameters on $\Rnum$ both analytically and via numerical solutions.
We are specifically interested in parameters that could be manipulated by public health policy: isolation efficacy, $\theta\_c$ and $\theta\_w$; \percap testing intensity, $\rho$; and the rate of test return, $\omega$. In particular, we look at the partial derivatives of $\Delta$ with respect to these parameters (Sec.\,\ref{app:rho}). 
We derived general expressions for these derivatives. However, we analyzed the effect of $\omega$ on $\Rnum$ for the special case of low testing intensity. Specifically, by making the restriction $\rho \ll 1$, we are able to Taylor-expand $\Delta$ at $\rho=0$ and analyze the resulting simplified derivatives to illustrate a surprising non-monotonic relationship between $\Rnum$ and $\omega$. 

The analytical calculation of the next-generation matrix and simplification of the $\Rnum$ expression was carried out in Maple \citep{maple14}. We used R \citep{r} for numerical solutions, in particular for plotting the contours of $\Delta$ (Eq.~\eqref{eq:del4a}) over a range of parameters.
We computed the values and contours of Delta at both low (\fref{pan}) and high (\fref{pan2}) testing intensities, and for both random testing ($w_S=w_I=w_R=1$) and targeted testing ($w_S=0.3$; $w_I=w_R=1$).

The low-testing case \fref{pan} reflects the case where $rho$ is small relative to the population size. Specifically, $\rho \in [0,0.013]$, and test return rate $\omega\in [1/12,2]$. This testing intensity reflects realistic testing rates during the \covid pandemic, i.e. a maximum of 1.3\% of the population per day, giving a maximum of 10000 tests/day in a population of size $N_0=10^6$ (this is approximately four times the maximum testing rate in Ontario, Canada in mid-2021). The less realistic high-testing case \fref{pan2} is included to highlight the occurrence of non-monotonic changes in $\Rnum$ with respect to $\rho$.
In \fref{pan2} the maximum capacity of $\rho$ is larger relative to the population size, $\rho \in [0,1/5)$ and the test return rate $\omega\in [1/5,2]$; these values are clearly unrealistic for a large population but might be relevant for some population undergoing focused testing, such as a sports league or university.
  The critical contour of $\Delta=1-\frac{\gamma}{\beta}$, corresponding to the threshold $\Rnum=1$, is shown as a dotted line in \fref{pan} and \fref{pan2}; combinations of $\rho$ and $\omega$ that lie above this critical contour will control the epidemic. The implied baseline value of $\Rnum=\frac{\beta}{\gamma}$ in these figures is 3, corresponding to a case where the epidemic spreads slowly even in the absence of testing and tracing. 
  
% %%%%%%%
\section{Results and discussion}

We can use the formula for $\Rnum$ \eqref{R0} to make a number of straightforward conclusions about parameters whose effects on $\Rnum$ are monotonic (i.e. the partial derivative of $\Delta$ has a consistent sign: Sections~\ref{app:rho}, \ref{app:omega}, \ref{app:w}).

\begin{enumerate}

\item \label{p1:eta} Increasing isolation efficacy for waiting ($\theta\_w$) and confirmed-positive ($\theta\_c$) individuals always decreases \Rnum (Eqs.~\ref{eq:del4_theta},~\ref{eq:d_del4_thetac},~\ref{eq:d_del4_thetaw});
\item \label{p1:rho} Higher testing intensity $\rho$ decreases $\Rnum$ if
%% \begin{enumerate} \item
testing is random (all $w_X$ equal) or testing intensity ($\rho$) is small (Eq.~\ref{eq:dd3dr}).
%% \end{enumerate}
\item \label{p1:omega} Increasing the rate of test return ($\omega$) always decreases \Rnum if waiting individuals do not isolate ($\theta_w=0$) (Eq.~\ref{eq:dlindo}).
\item \label{p1:w} Increasing testing focus, i.e. changing the testing weights from random ($w_S=w_I$) toward targeted  ($w_S<w_I$), always decreases \Rnum (Eq.~\ref{eq:d_del_wis}).
\end{enumerate}

\newpage
\begin{figure}[h!]
\centering
\begin{subfigure}[t]{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{codes/R0contour_random.pdf}
\caption{}\label{p.a}
\end{subfigure}
%
\begin{subfigure}[t]{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{codes/R0contour_TTI.pdf}
\caption{}\label{p.b}
\end{subfigure}
\caption{
{\bf A comparison of effectiveness control on $\Rnum$ at low level of \percap testing intensity $\rho$.}
Numerical evaluation of the effectiveness control parameter, $\Delta$ (Eq.~\ref{eq:del4}), with respect to changes in testing and isolation. Parameter values (Table~\ref{tab:params}):
$\beta=0.5$ 1/day, $1/\gamma= 6$ days; $\omega \in [1/12,2]$ 1/day;  $\rho \in [0,0.013]$ 1/day per capita; $\theta\_w$ and $\theta\_c$ vary between 0 (no effect of isolation) and 1 (complete elimination of transmission); $p_S=0$, $p_I=1$ and $p_R=0.5$. Contours of $\Delta$ are plotted for (a) random testing ($w_S=w_I=w_R=1$) and (b) targeted testing ($w_S=0.3$; $w_I=w_R=1$). 
The baseline basic reproduction number $\Rnum$ and the doubling time $r$, i.e. $\beta/\gamma$ and $\beta-\gamma$ respectively, are 3 and about 0.3 in this simulation.
}
\label{pan}
\end{figure}

\begin{figure}[h!]
\centering
\begin{subfigure}[t]{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{codes/R0contour_random2.pdf}
\caption{}
\end{subfigure}
%
\begin{subfigure}[t]{.49\textwidth}
\centering
\includegraphics[width=\linewidth]{codes/R0contour_TTI2.pdf}
\caption{}
\end{subfigure}
\caption{
{\bf A comparison of effectiveness control on $\Rnum$ at high level of \percap testing intensity $\rho$.}
We numerically evaluate the effectiveness control parameter, $\Delta$ (Eq.~\ref{eq:del4}), with respect to testing and isolation. We use the following parameters (see Table~\ref{tab:params} for a brief description):
$\omega \in [1/5,2]$ 1/day, $1/\gamma= 6$ days, $\rho \in [0,1/5)$ 1/day, $\theta\_w$ and $\theta\_c$ vary between 0 and 1 with 0 for no effect and 1 for full effect of isolation on the transmission probability, $\beta=0.5$ 1/day, $p_S=0$, $p_I=1$ and $p_R=0.5$. Contours of $\Delta$ are plotted for two testing strategies identified by a set of relative testing weights; (a) random testing where $w_S=w_I=w_R=1$ and (b) targeted testing where $w_S=0.3$ and $w_I=w_R=1$. The baseline basic reproduction number $\Rnum$ and the doubling time $r$, i.e. $\beta/\gamma$ and $\beta-\gamma$ respectively, are 3 and 0.3 in this simulation.
}
\label{pan2}
\end{figure}

However, there are also two specific cases where $\Delta$ changes \emph{non-monotonically}, in counterintuitive directions, as a function of testing and isolation parameters.

\begin{itemize}
\item We would generally expect increasing testing delays to increase \Rnum, thus decreasing effectiveness of control $\Delta$. This is in fact what we find when waiting individuals do not isolate ($\theta_w =0$, top row of \fref{pan}) --- as we move to the right within each plot in this row, $\Delta$ decreases.
However, when waiting individuals isolate ($\theta_w>0$), we more often see the opposite effect: longer testing delays lead to a greater control effect $\Delta$. This is because people waiting for negative tests are assumed to continue to isolate; this applies both to susceptibles and to people who became infected while waiting for negative test results. This effect outweighs the effect of confirmed individuals isolating except when this isolation parameter $\theta_c$ is substantially bigger than $\theta_w$. This result depends on the idea that, all else equal, people who have to wait longer for test results isolate at the same level (but for a longer time) as they would if the wait were shorter.
\item \fref{pan} also shows that greater testing intensity (increasing $\rho$) generally increases the effectiveness of control (moving up in each panel). This relationship can be reversed, however, at very high testing intensities. This can only occur when testing is targeted, and $\theta_w$ is relatively small (\fref{pan2}(b), right three panels of top row). It is theoretically possible for increasing testing intensity to \emph{increase} \Rnum because more rapid testing leaves more susceptibles in the ``waiting-for-negative-results'' category at the DFE; if these people become infected while waiting, they will need to wait for their negative test result before they can be tested again, receive a positive test, and then begin self-isolating. This effect is usually weak compared to the beneficial effects of testing.

\end{itemize}
  

%%%%%%%%%%%%
\section{Discussion}

\begin{enumerate}

\item {\bf A potential advantage of slow test reporting $\omega$, result~\ref{p1:omega};}

- Whether increasing $\omega$ lowers $\Rnum$ depends on the precise combination of model parameters  including $\rho$, testing strategies represented by compartment-specific testing weights, test sensitivity and specificity, and the level of isolation efficacy. 
- The potential advantage of slow test reporting is in the individual level as opposed to the community level, but seems inapplicable as a strategy.
- May be this mechanism combined with increasing testing intensity $\rho$ can be considered alongside other prevention methods, eg., social distancing etc, when the transmission is in the exponential-growth phase (in order to increase the generation interval).
- One reason in favor of prolonging $1/\omega$ is that it is easy to manipulate while increasing $\rho$ can be limited to the resources.

\item {\bf The counter-vailing effect of \percap testing intensity, $\rho$, on $\Rnum$;}
- The explanation here is that more rapid testing leaves more susceptibles in the ``waiting-for-no'' $S\_n$ category at the DFE and delay them to get to $I\_c$ where they are subject to a full isolation, thus no transmission.
- We are missing out on community-level advantages of fast testing.
- What is the explanation for having this counter-vailing effect of $\rho$ in targeted testing and not in the random one?
- May because in the targeted testing more $I\_u$s are tested compared to $S\_u$s, given 
 that higher $\omega$ leaves more people in $S\_n$ and $I\_n$ which results in more transmission.
- While targeted testing strategies, including targeting people with infection-like symptoms or the contacts of confirmed cases, are always more effective than random testing, as expected, we find that in some cases the direct effect of testing is that viral spread is greater for a slow test than for a fast test. This counter-intuitive effect can occur when people are cautious when awaiting a test result, and may not be robust to second-order effects of fast testing (such as better contact tracing).

\item {\bf Specifying the compartment-specific relative testing weights, Specifically $\frac{w_I}{w_S}$;}

- More targeted testing is always good in viral control,
- We incorporated the compartment-specific relative testing weights, $w_S$, $w_I$ and $w_R$, to model random testing and \emph{targeted} testing strategies. Here, in the case of targeted testing and for the simplicity and illustration purposes, we assumed that infected and recovered individuals are tested at three times the \percap rate of susceptible individuals, thus $w_I/w_S=3$ and $w_R=w_I$. Note that we have not specified a methodology to assign particular relative testing weights corresponding to a particular targeted testing scenario. 
Modeling different targeted testing strategies, equivalently test-specific testing weights in our framework, requires prior information of the conditional probabilities of getting tested for people in a given compartment. 
This can be implied when we would like to quantify and compare the effect of different levels of test focus for infectious people on the basic reproduction number $\Rnum$, and conclude about the disease spread management. For example, when people are tested for "screening", the individuals with potential higher mobility, eg. people who are getting on flights, get more tested and thus the corresponding heavier testing weight is assigned than people awaiting for a surgery and are probably going to stay in a long-term-care facility and consequently less mobile and more isolated to begin with. With our model, we would be able to compare the sensitivity of the disease dynamics, through $\Rnum$, with respect to testing different high-risk groups in the population. This part needs to be developed further in future work.

\item What can we say in the context of strength and speed paradigm?

\end{enumerate}

% %%%%%%%
\bibliography{SIRlibrary}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
% \widetext
\begin{center}
\textbf{\large Appendix}
\end{center}
\setcounter{equation}{0}
\setcounter{figure}{0}
\setcounter{table}{0}
% \setcounter{page}{1}
\makeatletter
\renewcommand{\theequation}{A\arabic{equation}}
\renewcommand{\thefigure}{A\arabic{figure}}
\renewcommand{\bibnumfmt}[1]{[A#1]}
\renewcommand{\citenumfont}[1]{A#1}

\subsection{Model and calculation of $\Rnum$}\label{app:R0}

The model in the form of a system of ordinary differential equations is 
\begin{subequations}\label{model}
\begin{align}
 d S\_u/dt &= -\Lambda S\_u - F_S S\_u + \omega S\_n, \\
 d S\_n/dt &= -(1-\theta\_w)\Lambda S\_n + (1-p_S) F_S S\_u - \omega S\_n, \\
 d S\_p/dt &= -(1-\theta\_w)\Lambda S\_p + p_S F_S S\_u - \omega S\_p, \\
 d S\_c/dt &= -(1-\theta\_c)\Lambda S\_c + \omega S\_p, \\
 d I\_u/dt &= \Lambda S\_u - F_I I\_u + \omega I\_n  - \gamma I\_u, \\
 d I\_n/dt &= (1-\theta\_w)\Lambda S\_n + (1-p_I) F_I I\_u - \omega I\_n -\gamma I\_n, \\
 d I\_p/dt &= (1-\theta\_w)\Lambda S\_p + p_I F_I I\_u - \omega I\_p -\gamma I\_p, \\
 d I\_c/dt &= (1-\theta\_c)\Lambda S\_c + \omega I\_p - \gamma I\_c, \\
 d R\_u/dt &= \gamma I\_u - F_R R\_u + \omega R\_n, \\
 d R\_n/dt &= \gamma I\_n + (1-p_R) F_R R\_u - \omega R\_n, \\
 d R\_p/dt &= \gamma I\_p + p_R F_R R\_u  - \omega R\_p, \\
 d R\_c/dt&= \gamma I\_c + \omega R\_p, \\
 dN/dt &= \omega (S\_n + I\_n + R\_n),  \\
 dP/dt &= \omega(I\_p + R\_p) ,
\end{align}
\end{subequations}
%
where parameters are specified in Table \ref{tab:params}. The next generation matrix for this model is $G = F V^{-1}$, where matrix $F$ represents the inflow of new infection to the infected compartments and matrix $V$ represents the flow in the infected compartments when the population is totally susceptible. 
Matrices $F$ and $V$ are
\begin{align}
\label{FV}
F =& \beta/N_0 \left[ \begin {array}{cccc} 
S\_u^* & (1-\theta\_w)\,S\_u^* & (1-\theta\_w)\,S\_u^* & (1-\theta\_c)\,S\_u^*\\
(1-\theta\_w)S\_n^* & (1-\theta\_w)^2\,S\_n^* & (1-\theta\_w)^2\,S\_n^* & (1-\theta\_w)(1-\theta\_c)\,S\_n^* \\ 
0&0&0&0\\
0&0&0&0
 \end {array} \right] \\
 =&\beta/N_0 \left[ \begin {array}{c} S\_u^* \\ (1-\theta\_w)S\_n^* \\ 0 \\ 0 \end {array} \right]
        \left[ \begin {array}{cccc} 1, \, 1-\theta\_w, \, 1-\theta\_w, \, 1-\theta\_c \end {array} \right], \text{and}\\  V=&
 \left[ \begin {array}{cccc}  
\hat F_I+\gamma&-\omega&0&0\\
-(1-p_I)\hat F_I&\omega+\gamma&0&0\\
-p_I \hat F_I&0&\omega+\gamma&0\\
0&0&-\omega&\gamma
\end {array} \right].
\end{align}
The matrix inverse of $V$ is 
\begin{align}
\label{vinv}
V^{-1} =&
\frac{1}{\gamma C}
\left[ \begin {array}{cccc}
\gamma(\omega+\gamma)^2 & \gamma\omega(\omega+\gamma)&0&0\\ \noalign{\medskip}
\gamma(\omega+\gamma)(1-p_I) \hat F_I & \gamma(\omega+\gamma)(\hat F_I+\gamma)&0&0 \\ \noalign{\medskip}
\gamma(\omega+\gamma) p_I \hat F_I & \gamma\omega p_I \hat F_I & C \gamma/(\omega+\gamma) & 0 \\ \noalign{\medskip}
\omega(\omega+\gamma) p_I \hat F_I & \omega^2 p_I \hat F_I & C \omega/(\omega+\gamma) & C
\end {array} \right],
\end{align}
where $C= \big( \gamma(\omega+\gamma)+(\gamma+\omega p_I)\hat F_I \big) (\omega+\gamma)$ and $\hat F_I$ is the \percap testing rate for the infected people and represented in Eq.\,\eqref{eq:fi}. Note that all the columns of matrix $V^{-1}$ summ up to $1/\gamma$.

The particular form of $F$ with two rows of zeros at the bottom results in the following blocked form of matrix $G$.
\begin{equation}
\label{mat:G}
G = \left[ \begin {array}{cc}
G_{11}&G_{12}\\
0&0
\end {array} \right],
\end{equation}
where both blocked matrices $G_{11}$ and $G_{12}$ are 2 by 2. Given the upper triangular form of matrix $G$, the basic reproduction number $\Rnum$ (defined as the spectral radius of matrix $G$) is only determined by the blocked matrix $G_{11}$,
\begin{equation}
\label{G11}
G_{11} = \frac{\beta}{\gamma \, C} 
\left[ \begin {array}{c} (\omega-\rho)/\omega \\ (1-\theta\_w)\rho/\omega \end {array} \right]
\left[ \begin {array}{cccc} 1, \, 1-\theta\_w, \, 1-\theta\_w, \, 1-\theta\_c \end {array} \right]
\left[ \begin {array}{cc}
\gamma(\omega+\gamma)^2 & \gamma\omega(\omega+\gamma)\\ \noalign{\medskip}
\gamma(\omega+\gamma)(1-p_I)\hat F_I & \gamma(\omega+\gamma)(\hat F_I+\gamma) \\ \noalign{\medskip}
\gamma(\omega+\gamma) p_I \hat F_I & \gamma\omega p_I \hat F_I \\ \noalign{\medskip}
\omega(\omega+\gamma) p_I \hat F_I & \omega^2 p_I \hat F_I
\end {array} \right].
\end{equation}
It is notable that matrix $F$ \eqref{FV} has rank one and consequently $G_{11}$ does so. That is $G_{11}$ has only one non-zero eigenvalue which is $\Rnum$.

The expression of $\Rnum$ has a complicated form with all of the model parameters involved. This expression can be simplified and represented given the specific form of matrix $G_{11}$ \eqref{G11}. For the purpose of simplicity we present $\Rnum$ in the manuscript in terms of expressions $C$, $C1$ and $C2$, specified in \eqref{eq:C12}. 

It remains hard to show that the reproduction number $\Rnum$ is decreasing with respect to \percap testing intensity, $\rho$, and the speed of the test return, $\omega$, for the feasible ranges of the parameters, that is
\begin{align}
\label{cond}
& \omega>0, \\
& 0 \leq \rho<\omega,\\ 
& 0 \leq \theta\_w \leq \theta\_c \leq 1, \\
& \frac{w_I}{w_S}\geq 1.
\end{align}
In realistic cases the testing rate $\rho$ is very small (i.e., only a small fraction of the population can be tested every day); it is thus reasonable to use a linear approximation of $\Rnum$ for $\rho \ll 1$ to analyze the behaviour of $\Rnum$ with respect to $\omega$ (see section \ref{app:omega}). 
In the next section we provide an equivalent representation of $\Rnum$ in order to show that increasing testing intensity typically decreases $\Rnum$.

% %%%%%%%
\subsection{More testing intensity may decrease $\Rnum$}\label{app:rho}

This section shows that $\pro{\Delta}$ can be positive or negative, with $\Delta$ defined in Eq.\,\eqref{eq:C12}, and thus $\pro{\Rnum} < 0$, where $\Rnum$ is given in Eq.~\eqref{R0}. We rewrite matrix $G_{11}$ in \eqref{G11} in the following form to simplify the calculations:
\begin{equation}
\label{G112}
G_{11} = \frac{\beta}{\gamma \, C} 
\left[ \begin {array}{c}  S\_u^*/N_0 \\ (1-\theta\_w)\,S\_n^*/N_0  \end {array} \right]
\left[ \begin {array}{cccc} 
C-C_1, C-C_2\end {array} \right],
\end{equation}
where $C$ is the same as the one in Eq. \eqref{eq:C12}, i.e., 
$$C=(\omega+\gamma)(\gamma(\omega+\gamma)+(\omega\,p_I+\gamma)\,\hat F_I),$$
and $C_1$ and $C_2$ are 
\begin{align*}
% \label{eq:C12}
C_1 =& (\omega+\gamma)(\theta\_w \, \gamma+\theta\_c\, \omega\, p_I) \hat F_I,\\
C_2 =& \big( \omega\gamma(1+p_I)\hat F_I+\gamma^2\,(\omega+\gamma+\hat F_I)\big)\theta\_w + \omega^2\,p_I\,\hat F_I\,\theta\_c,
\end{align*}
where $\hat F_I$ is given in Eq.\,\eqref{eq:fi}.
Note that for analysis brevity, we let $N_0=1$, thus $S\_u^*$ and $S\_n^*$ are in the scale of 0 to 1.
$\Rnum$ is in the same form as in Eq. \eqref{R0}  
$$\Rnum= \frac{\beta}{\gamma} (1-\Delta),$$
where 
\begin{equation*}
\label{eq:del4}
\Delta= \frac{1}{C}\big(C_1\,S\_u^*+(C_2(1-\theta\_w)+C\,\theta\_w)\,S\_n^*\big).
\end{equation*}

{\bf The first goal}
is to explore how changes in isolation, $\theta\_w$ and $\theta\_c$, affects $\Rnum$. Mathematically we would like to verify the sign of $\pder \Rnum{\theta\_w}$ and $\pder \Rnum{\theta\_c}$. We start with simplifying $\Delta$ \eqref{eq:del4} by factoring $\theta\_w$ and $\theta\_c$ in Eq.\,\eqref{eq:del4}. Thus, $\Delta$ can be rewritten as
\begin{equation}
\label{eq:del4_theta}
\Delta= \frac{1}{C}\Big(
-D_1\,S\_n^*\,\boldsymbol {\theta\_w^2}+
\big(-\omega^2\,p_I\,\hat F_I\,S\_n^*\,\boldsymbol{\theta\_c}\,+\,D_2\,S\_n^*\,+\,\gamma\,\hat F_I(\omega+\gamma) \big)\boldsymbol{\theta\_w}+
(\omega+\gamma\,S\_u^*)\omega\,p_I\,\hat F_I\,\boldsymbol{\theta\_c}
\Big),
\end{equation}
where
\begin{align}
\label{eq:del4_d1d2}
D_1=& (\omega+\gamma)\gamma^2+(\omega+\gamma+\omega\,p_I)\gamma\,\hat F_I, \\
D_2=& (3\omega+2\gamma)\gamma^2+(\omega+\gamma+2\omega\,p_I)\gamma\,\hat F_I+(\gamma+p_I\,\hat F_I)\omega^2.
\end{align}
$\Delta$, Eq.\,\eqref{eq:del4_theta}, is linear in $\theta\_c$ with a positive coefficient. thus
\begin{equation}
\label{eq:d_del4_thetac}
\pder\Delta{\theta\_c}=1/C(\gamma S\_u^*+\omega(1-\theta\_w S\_n^*))\omega p_I \hat F_I.
\end{equation}
This results in increasing $\Delta$, thus decreasing $\Rnum$ with respect to $\theta\_c$, that is $\pder \Rnum{\theta\_c}\leq 0$. Note that $C$ is independent of $\theta\_c$ and $\theta\_w$. 

With a similar logic, $\Delta$ \eqref{eq:del4_theta} is a concave-down quadratic equation in $\theta\_w$, given by
\begin{equation}
\label{eq:del4_thetaw}
1/C\,\Big( -D_1\,S\_n^*\,\boldsymbol {\theta\_w^2}+
\big(-\omega^2\,p_I\,\hat F_I\,S\_n^*\,\boldsymbol{\theta\_c}\,+\,D_2\,S\_n^*\,+\,\gamma\,\hat F_I(\omega+\gamma) \big)\boldsymbol{\theta\_w} \Big).
\end{equation}
We show that the feasible range of $\theta\_w$ lies between 0 and the vertex of this parabola where the parabola is increasing in $\theta\_w$, and so does $\Delta$ which results in inferring $\pder\Rnum{\theta\_w}\leq 0$.
It is enough to show that partial derivative of the expression \eqref{eq:del4_thetaw} with respect to $\theta\_w$ at $\theta\_w=1$ is non-negative. It follows that
\begin{align}
\label{eq:d_del4_thetaw}
\pder\Delta{\theta\_w}\bigg\rvert_{\theta\_w=1} =&
1/C\Big( (D_2-2D_1-\omega^2\,p_I\,\hat F_I\,\theta\_c)\,S\_n^*+\gamma\,\hat F_I(\omega+\gamma) \Big) \\\notag
=& 1/C\Big( (\gamma(\omega+\gamma)+\gamma\omega^2+(1-\theta\_c)\omega^2\,p_I\,\hat F_I )\,S\_n^*
+\gamma(\omega+\gamma)\,\hat F_I\,(1-S\_n^*) \Big),
\end{align}
which is a positive quantity, given that $\theta\_c$ and $S\_n^*$ vary between 0 and 1.

{\bf The second goal} is to explore how changes in \percap testing intensity $\rho$ affects $\Rnum$. Mathematically we would like to verify the sign of $\pder\Rnum{\rho}$, which specifically depends on $\pder\Delta{\rho}$. We use the derived expressions for $S\_u^*$ and $S\_n^*$, given by Eqs.\,\eqref{dfe}, in $\Delta$ \eqref{eq:del4}. Also, we define $\phi = \hat F_S = \frac{\rho \omega}{\omega-\rho}$, to reparameterize $\rho$. This is mainly to avoid singularity in $\hat F_I$ \eqref{eq:fi}, when testing intensity $\rho$ is very close to the rate of test return $\omega$. Thus, $\rho$ is reparameterized as 
\begin{equation}
\label{eq:phi}
\rho=\frac{\omega \phi}{\omega+\phi}.
\end{equation}
This one-to-one monotonic reparameterization enables us to simplify the mathematical expressions and explore the simpler $\pder\Delta{\phi}$ instead of the complicated $\pder\Delta{\rho}$.
The derivative is 
\begin{align}
\label{eq:dd3dr}
\partial\Delta/\partial\phi=& \frac{1}{d_3} (a_3\,\phi^2+b_3\,\phi+c_3),
\end{align}
where
\begin{align}
\label{eq:abcd2}
a_3& = \frac{w_I}{w_S} \Bigg(
&& (1-\theta\_w)\,(1+\frac{w_I}{w_S})\theta\_w\,\gamma^3 +(1-\theta\_c)\,p_I^2\,\theta\_w\,\frac{w_I}{w_S}\,\omega^3 \\ \notag
& ~ &&+\Big( \big( (1-\theta\_w-\frac{w_I}{w_S})\,\theta\_c +(3-2\theta\_w)\,\theta\_w\frac{w_I}{w_S} \big)\,p_I +(1-\theta\_w)\,(1+\frac{w_I}{w_S})\theta\_w  \Big)\,\omega\,\gamma^2 \\ \notag
& ~ &&+\Big(
\big((1-\theta\_w-\theta\_w\,\frac{w_I}{w_S})\,\theta\_c+ (2-\theta\_w)\,\theta\_w\,\frac{w_I}{w_S} \big)\,p_I
+(2\,\theta\_w-\theta\_w^2-\theta\_c)\,\frac{w_I}{w_S}\,p_I^2
\Big)\,\omega^2\,\gamma \Bigg), \\ \notag
b_3& = && \hspace{-1cm} 2\frac{w_I}{w_S}\,(\omega+\gamma)\gamma\Big(
(\omega+\gamma+\omega\,p_I)(2-\theta\_w)\,\gamma\,\theta\_w+ (1-\theta\_w)\,\omega^2 p_I\theta\_c+\omega^2 p_I\theta\_w
\Big) ,\\ \notag
c_3& = && \hspace{-1cm} (\omega+\gamma)^2\,\gamma\Big(
(2-\theta\_w)\,\gamma^2\,\theta\_w+
(1+\frac{w_I}{w_S})\,\omega\,\gamma\,\theta\_w+
\frac{w_I}{w_S} \omega^2 p_I\theta\_c \Big),\\ \notag
d_3&  = && \hspace{-1cm} \frac{(\omega+\gamma)}{\omega}\, \Big((\omega p_I+\gamma)\frac{w_I}{w_S}\phi\,+\,(\omega+\gamma)\gamma \Big)^2(\omega+\phi)^2.
\end{align}
Note that $\phi\geq 0$, also $b_3$, $c_3$ and $d_3$ are all positive. However $a_3$ can be positive or negative.
If $a_3\geq 0$, $\partial\Delta/\partial\phi \geq 0$ for all feasible range of parameters, thus $\pro\Rnum \leq 0$. It is straight forward to show that $a_3\geq 0$ in case of random testing strategy, i.e., $w\_S=w\_I=1$. 
If $a_3 < 0$, then the quadratic expression in the numerator of \eqref{eq:dd3dr} has a positive root, $\phi^*$, such that for $\phi>\phi^*$, $\partial\Delta/\partial\phi < 0$. 

An example of this counter-vailing effect of $\phi$, and consequently $\rho$, on $\Rnum$ occurs when $\theta\_w=0$ and $\theta\_c=1$.
This is illustrated in the top-right panel of the \fref{pan2} panel (b), where the strength of isolation for awaiting people is the least, but the most for the confirmed cases. In this case, simplifying $a_3$ in Eq.~\eqref{eq:abcd2} gives $$a_3=\frac{w_I}{w_S}\,\omega\,\gamma\,p_I((\omega+\gamma)-\frac{w_I}{w_S}(\omega\,p_I+\gamma)).$$
Specifically, in the case of targeted testing which is identified by $\frac{w_I}{w_S}> 1$, and using a perfect sensitive test, thus $p_I=1$, there exists a range for $\rho$ over which $\pder\Rnum{\rho}\leq\,0$.  
Note that $\rho$ and $\omega$ have a similar mechanism in delaying people to get into $I\_c$, thus we would expect to see the non-trivial counter-vailing effect of these two parameters on $\Rnum$. 

% %%%%%%%
\subsection{rate of returning tests} \label{app:omega}
{\bf The third goal} is to explore how changes in the rate of test return $\omega$ affects $\Rnum$. Mathematically we would like to verify the sign of $\pder\Rnum{\omega}$, which specifically depends on $\pder\Delta{\omega}$. We use
the linearization of $\Rnum$ around $\rho=0$ to show that there a non-monotonic relationship between $\Rnum$  and $\omega$. The Taylor expansion of $\Delta$ at $\rho=0$ is
\begin{equation}
\label{eq:lin}
\Delta = \frac{\rho}{\omega\,\gamma(\omega+\gamma)} \Big(
\frac{w_I}{w_S}\,\omega^2\,p_I\,\theta\_c+(\frac{w_I}{w_S}+1)\,\gamma\omega\theta\_w\,+\gamma^2\,\theta\_w(2-\theta\_w)
\Big). 
\end{equation}
This results in
\begin{equation}
\label{eq:dlindo}
\pder\Delta{\omega} = \frac{\rho}{\omega^2\,(\omega+\gamma)^2} \Big(
(p_I\,\frac{w_I}{w_S}\theta\_c\,-(1+\frac{w_I}{w_S})\theta\_w)\omega^2+2\theta_w\,\gamma(\theta_w-2)\,\omega+\theta_w\,\gamma^2\,(\theta_w-2)
\Big),
\end{equation}
around $\rho=0$.
% \ali{I stoped here!}

% %%%%%%%
\subsection{On Testing Rate and Numerical Singularity}

In this work, we didn't do any numerical solutions for the trajectories in our analysis. However, if one tries to do so there would be a singularity issue to deal with. 
Specifically, the numerical singularity issue with the chosen $\sigma$ \eqref{sigma} is that the population in $S$ compartments appeared to blow up when the DFE is achieved. This is once the only untested people are susceptibles, the FOI will become $\Lambda=0$, testing rate $F_s=\rho N_0/S\_u$. Thus, the first equation of the model \eqref{model} will become
$d S\_u/dt = - \rho N_0 + \omega S\_n$. Thus changes in $S\_u$ will be no longer dependent on $S\_u$ with a linear rate of leaving the $S\_u$ compartment.
IN fact the testing rate, $\sigma$, should be formulated such that people from the untested compartments will not be tested if they are not there.
One way to fix this issue, is to consider a maximum testing rate, $\tau$ (1/day). In general, we want to test at a rate of $\rho$ across the whole population. This won't always be possible, so we impose a maximum rate of $\tau$ per testable person and redefine $\sigma = \frac{\tau \rho N_0}{\tau W + \rho N_0}$, with the assumption that $\tau \gg \rho$. This alteration in $\sigma$, does not change any results related to $\Rnum$, thus we only impose it in the simulation of the epidemic dynamic.


% %%%%%%%
\subsection{The effect of testing focus parameter $\frac{w_I}{w_S}$ on $\Rnum$} \label{app:w}

We define $w\_{IS}=\frac{w_I}{w_S}$.
\begin{align}
\label{eq:d_del_wis}
\pder \Delta{w\_{IS}}= \dfrac{(\omega-\rho)\,(\omega(\omega-\rho\theta\_w)+\gamma(\omega-\rho))\,(\theta\_w\gamma+\theta\_c\omega\,p\_I)}
{(-\omega^2\,\gamma+\omega\,\gamma\,\rho-\gamma\,\rho\,\omega\,w\_{IS}-
\omega\,\gamma^2+\gamma^2\,\rho-\omega^2\,p_I\,\rho\,w\_{IS})^2},
\end{align}
which is a positive quantity. Thus, $\pder \Rnum{w\_{IS}}\leq 0$. Therefore, increasing the focus of testing on the infectious people will result in less transmission.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \todo{Fady:To be change accordingly please.} 
% Perhaps counter-intuitively, the equation above does not predict that $\Rnum$ is monotone decreasing with respect to $\omega$. In other words; our model does not predict that returning test results more rapidly \textit{always} lower $\Rnum$. In order to gain insight into this intriguing behavior, we examine the zeroes of $\frac{\partial{\Rnum}}{\partial{\omega}}(\omega)$.
% Defining the following quantity, $Q$, will help us write the roots of $\partial{\Rnum}/\partial{\omega}$ neatly as follows.
% \begin{align}\label{eq:defQ}
%     Q =& \frac{w_I}{w_S}\left(1-\frac{n_t-1}{n_w-1}p_I \right).
% \end{align}
% With that in mind, we can write the roots of $\partial{\Rnum}/\partial{\omega}$ as
% \begin{align}
%     \omega_1 =& \frac{\gamma}{-\sqrt{1-Q}-1} \\
%     \omega_2 =& \frac{\gamma}{\sqrt{1-Q}-1}.
% \end{align}
% 
% Note that the zeroes are real if and only if $Q < 1$. Note that have $\theta\_c > \theta\_w$, so if $p_I \approx 1$, we will have $Q < 0 < 1$. Thus, if we assume near-perfect test sensitivity, $\omega_1$ and $\omega_2$ will be real. 
% 
% Assuming $\omega_1, \omega_2$ are real, it is easy to confirm that $\omega_1 < 0$ by looking at the denominator. To see that $\omega_2 > 0$, recall that $Q < 0$, so $\sqrt{1-Q} > 1$ and so $\sqrt{1-Q} -1 > 0$. Knowing that $\omega_1 < 0$, the only root of interest (i.e., biologically relevant quantity) is $\omega_2$. 
% 
% We can prove that $\partial{\Rnum}/\partial{\omega} > 0$ when $\omega \in (0,\omega_2)$ and $\partial{\Rnum}/\partial{\omega} < 0$ when $\omega \in (\omega_2,\infty)$ by computing the limits of $\partial{\Rnum}/\partial{\omega}$ at $0$ and $\infty$ respectively. So it follows that $\Rnum$ has a global maximum with respect to $\omega$ at $\omega = \omega_2$.
% 
% Now we want to characterize the parameter regions on which $\partial{\Rnum}/\partial{\omega} < 0$ (i.e., the conditions under which returning test results more rapidly is favorable). By the previous analysis, this is equivalent to solving for $\omega > \omega_2$. So
% \begin{align}
%     &\omega > \omega_2 \nonumber \\
%     &\omega > \frac{\gamma}{\sqrt{1-Q}-1} \nonumber \\
%     &\sqrt{1-Q} > \frac{\gamma}{\omega}+1 \\
%     &1-Q > (\frac{\gamma}{\omega}+1)^2.
% \end{align}
% Substituting in $Q$ from \eqref{eq:defQ} we have
% \begin{align}
%     &1-\frac{w_I}{w_S}\left(1-\frac{n_{t}-1}{n_{\omega}-1}P_{i}\right)> \left(\frac{\gamma}{\omega}+1\right)^2 \\
%     &-\frac{w_I}{w_S}\left(1-\frac{n_{t}-1}{n_{\omega}-1}P_{i}\right)> \left(\frac{\gamma}{\omega}+1\right)^2+1 \\    
%     &\frac{w_I}{w_S}\left(\frac{1-n_{t}}{1-n_{\omega}}P_{i}-1\right)> \left(\frac{\gamma}{\omega}+1\right)^2+1\label{eq:necsuf}.
% \end{align}
% Since all steps in deriving \eqref{eq:necsuf} are reversible, \eqref{eq:necsuf} gives a necessary and sufficient condition for $\omega > \omega_2$, which characterizes when returning tests more rapidly would cause a decrease in $\Rnum$.
% % %%%%%%%
% \subsection{Expensive vs.\ cheap tests}
% 
% The use of tests cheaper than RT-PCR has been proposed as a potential strategy for containing the \covid pandemic. While cheaper tests may be less sensitive and reliable than RT-PCR, they allow for broader and more intense testing. In the analysis below, we compare the $\Rnum$ predicted by our model depending on the testing strategy. 
% 
% Consider a test that allows us to test at rate $\rho_1$ and has sensitivity $P_{i,1}$, and another test that allows us to test at $\rho_2$ and has sensitivity $P_{i,2}$. Suppose that $\rho_1 > \rho_2$. Recall that the linearization of $\Rnum$ around $\rho \approx 0$ is given by $$\Rnum \approx \beta/\gamma + \frac{\beta \rho}{\omega (\omega+\gamma) \gamma^2 w_S} \Big(\gamma(-\theta\_w)(\gamma w_S+\omega w_I) + (-\theta\_c)p_I w_I \omega^2 \Big).$$
% 
% 
% Treating $\Rnum$ as a function of $\rho$ and $P_i$,we can reduce the inequality $$\Rnum(\rho_2, p_{I,2}) < \Rnum(\rho_1, p_{I,1})$$ into 
% 
% \begin{align}\label{eq:rho1vsrho2}
%     &\rho_1\left(\gamma(-\theta\_w)(\gamma w_S + \omega w_I) + (-\theta\_c)p_{I,1}w_I\omega^2\right) - \rho_2\left(\gamma(-\theta\_w)(\gamma w_S + \omega w_I) + (-\theta\_c)p_{I, 2}w_I\omega^2\right) > 0 \nonumber \\
%     &\vdots \nonumber \\
%     &\frac{\rho_2P_{i, 2}-\rho_1P_{i, 1} }{\rho_1-\rho_2} > \frac{\theta\_w}{\theta\_c}\cdot \frac{\gamma(\gamma w_S + \omega w_I)}{\omega^2 w_I}
% \end{align}
% 
% Note that the RHS is positive, thus a necessary condition for the inequality above to hold is that $\rho_2P_{i,2} > \rho_1P_{i,1}$, equivalently 
% 
% \begin{equation}
% \frac{P_{i,2}}{P_{i,1}} > \frac{\rho_1}{\rho_2}.
% \end{equation}
% 
% To state an example of this, if test $A$ is three times as expensive as test $B$ (and hence one can test three times as many people with test $B$), using test $A$ rather than $B$ will be favorable only if test $A$ is at least 3 times more sensitive than test $B$. Note that this is a necessary but not sufficient condition, so even if test $A$ is three times more sensitive, it is still possible for test $B$ to be more effective. 
% 
% \cref{eq:rho1vsrho2} tells us precisely when a test corresponding to $\rho_2, P_{i,2}$ will yield a lower $\Rnum$ than a test corresponding to $\rho_1, P_{i,1}$, where $\rho_1 > \rho_2$. Some of the qualitative \textit{trends} that favor test 2 (the higher-sensitivity test) include
% 
% \begin{itemize}
%     \item individuals who test positive self-isolate much more than individuals who are waiting for their test result.
%     \item the time it takes to return tests is much shorter than the mean infectious period.
%     \item the testing intensity is much greater for infected individuals than susceptible individuals.
% \end{itemize}


\end{document}
